---
import facebookImg from "@uswds-images/usa-icons/facebook.svg";
import xImg from "@uswds-images/usa-icons/x.svg";
import youtubeImg from "@uswds-images/usa-icons/youtube.svg";
import instagramImg from "@uswds-images/usa-icons/instagram.svg";
import rssFeedImg from "@uswds-images/usa-icons/rss_feed.svg";
import { Image } from "astro:assets";
import { cleanConnectSection } from "@/utilities/preFooterBig";
import {
  type ConnectSectionModel,
  type ContactCenter,
  type SocialLink,
  SocialPlatform,
} from "@/env";

const { connectSection, gridColClass } = Astro.props;

const cleanedConnectSection: ConnectSectionModel =
  cleanConnectSection(connectSection);
const contactCenter: ContactCenter | undefined =
  cleanedConnectSection?.contactCenter;
const socialLinks: SocialLink[] | undefined =
  cleanedConnectSection?.socialLinks;
---

{
  cleanedConnectSection && (
    <>
      <div class={gridColClass}>
        <nav
          class="usa-footer__nav"
          aria-label="Pre-footer contact center and social links"
        >
          {contactCenter && (
            <div class="grid-row grid-gap-4 grid-col-auto">
              <section class="usa-footer__primary-content usa-footer__primary-content--collapsible">
                <h4 class="usa-footer__primary-link">
                  {contactCenter.name || "\u00A0"}
                </h4>

                <ul
                  class="usa-list usa-list--unstyled"
                  style="white-space: nowrap;"
                >
                  {contactCenter.phone && (
                    <li class="usa-footer__secondary-content usa-footer__secondary-link">
                      <a href={`tel:${contactCenter.phone}`}>
                        {contactCenter.phone}
                      </a>
                    </li>
                  )}
                  {contactCenter.email && (
                    <li class="usa-footer__secondary-content usa-footer__secondary-link">
                      <a href={`mailto:${contactCenter.email}`}>
                        {contactCenter.email}
                      </a>
                    </li>
                  )}
                </ul>
              </section>
            </div>
          )}

          {socialLinks && (
            <div class="usa-footer__social-links grid-row grid-gap-1">
              {socialLinks.map((sm) => (
                <div class="grid-col-auto">
                  <a
                    href={sm.url}
                    class="usa-social-link"
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label="{sm.platform} (opens in new tab)"
                  >
                    <Image
                      src={
                        sm.platform === SocialPlatform.FACEBOOK
                          ? facebookImg
                          : sm.platform === SocialPlatform.X
                            ? xImg
                            : sm.platform === SocialPlatform.INSTAGRAM
                              ? instagramImg
                              : sm.platform === SocialPlatform.YOUTUBE
                                ? youtubeImg
                                : sm.platform === SocialPlatform.RSS_FEED
                                  ? rssFeedImg
                                  : ""
                      }
                      class="usa-social-link__icon"
                      alt={sm.url}
                      loading="lazy"
                      decoding="async"
                    />
                  </a>
                </div>
              ))}
            </div>
          )}
        </nav>
      </div>
    </>
  )
}

<style>
  .usa-footer__social-links {
    justify-content: flex-start;
  }
</style>
