---
import Layout from "../layouts/Layout.astro";
import { createGetStaticPathForPages, fetchPageSlug } from "@/utilities/fetch";
import PageWithSideNav from "@/components/PageWithSideNav.astro";
import RichText from "@/components/RichText.astro";

const { slug } = Astro.params;

const collectionName = "pages";

let data: any;

const page = await fetchPageSlug(collectionName, slug);

if (!page) {
  return Astro.redirect("/404");
}

const pageContent = page.content;
const pageTitle = page.title;

export const getStaticPaths = createGetStaticPathForPages();
---

<Layout title={pageTitle}>
  <PageWithSideNav
    heading={pageTitle}
    showSideNav={true}
    currentPath={`/${slug}`}
    sideNavId={page.sideNavigation?.id}
  >
    <RichText content={pageContent} />
  </PageWithSideNav>
</Layout>
