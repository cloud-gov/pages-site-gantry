---
import { getEntry, type CollectionEntry } from "astro:content";
import { convertLexicalToHTML } from "@payloadcms/richtext-lexical/html";
import "../../index.scss";
import Layout from "../../layouts/Layout.astro";
import { createGetStaticPath } from "@/utilities/staticPath";
const { slug } = Astro.params;
let data: CollectionEntry<"news">["data"];

if (!Astro.isPrerendered) {
  const n = await getEntry("news", slug);
  if (!n) return Astro.redirect("/404");
  ({ data } = n);
} else {
  ({ data } = Astro.props);
}

export const getStaticPaths = createGetStaticPath("news");
---

<Layout title={data.title}>
  <article class="grid-container">
    <h1 set:html={data.title} />
    <section
      class="usa-prose"
      set:html={convertLexicalToHTML({ data: data.content })}
    />
  </article>
</Layout>
